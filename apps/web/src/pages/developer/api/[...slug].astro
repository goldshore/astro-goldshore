---
import Layout from '../../../layouts/BaseLayout.astro';
import ApiSidebar from '../../../components/ApiSidebar.astro';
import ApiEndpoint from '../../../components/ApiEndpoint.astro';

// Import the data directly for build time if possible, or fetch it.
// Given the previous error, let's try to load it from a local file if available,
// or use a placeholder if we are depending on runtime fetch which might be tricky in SSG/SSR mixed modes.
// For now, let's assume we can fetch or require it.

const { slug } = Astro.params;
// Handle slug as array or string depending on Astro version/config, usually string for [...slug] but params might be parsed.
// actually Astro.params.slug is a string for [...slug].
const endpointId = slug || '';

---

// We need to define getStaticPaths if we are in static mode, or use SSR.
// The config says `output: 'server'`, so we don't need getStaticPaths.

    <ApiSidebar openapi={openapi} />
const { slug } = Astro.params;
const endpoint = slug || '';

// Mock data or fetch logic here.
// In a real scenario, we might import this from `@goldshore/api-spec` or similar.
const openapi = {
  info: { title: 'GoldShore API', version: '1.0.0' },
  paths: {
    '/system/status': {
      get: { summary: 'Get System Status', description: 'Returns the health of the system.' }
    }
  }
};
---

<Layout title="API Reference">
  <div class="api-container">
    <ApiSidebar openapi={openapi} />
    <main class="api-main">
      <ApiEndpoint openapi={openapi} endpoint={endpoint} />
    </main>
  </div>
</Layout>

<style>
  .api-container {
    display: flex;
    min-height: 100vh;
    background: var(--color-surface-1);
  }
  .api-main {
    flex: 1;
    padding: var(--space-4);
  }
</style>

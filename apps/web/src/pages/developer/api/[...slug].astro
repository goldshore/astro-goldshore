---
import Layout from '../../../layouts/BaseLayout.astro';
import ApiSidebar from '../../../components/ApiSidebar.astro';
import ApiEndpoint from '../../../components/ApiEndpoint.astro';

// Import the data directly for build time if possible, or fetch it.
// Given the previous error, let's try to load it from a local file if available,
// or use a placeholder if we are depending on runtime fetch which might be tricky in SSG/SSR mixed modes.
// For now, let's assume we can fetch or require it.

// NOTE: Ideally this would come from a shared package or a fetched URL.
// Since we don't have the file 'apps/web/src/data/v1.json' in the file list I saw earlier,
// I will attempt to fetch it or define a mock if it fails.
// However, the error log showed the file had `const version = 'v1'` inside a `<style>` block.
// I am rewriting this file to be a proper Astro component.

// We need to define getStaticPaths if we are in static mode, or use SSR.
// The config says `output: 'server'`, so we don't need getStaticPaths.

const { slug } = Astro.params;
const endpoint = slug || '';

// Mock data or fetch logic here.
// In a real scenario, we might import this from `@goldshore/api-spec` or similar.
const openapi = {
  info: { title: 'GoldShore API', version: '1.0.0' },
  paths: {
    '/system/status': {
      get: { summary: 'Get System Status', description: 'Returns the health of the system.' }
    }
  }
};
---

<Layout title="API Reference">
  <div class="api-container">
    <ApiSidebar openapi={openapi} />
    <main class="api-main">
      <ApiEndpoint openapi={openapi} endpoint={endpoint} />
    </main>
  </div>
</Layout>

<style>
  .api-container {
    display: flex;
    min-height: 100vh;
    background: var(--color-surface-1);
  }
  .api-main {
    flex: 1;
    padding: var(--space-4);
  }
</style>

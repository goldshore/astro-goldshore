#!/usr/bin/env node
/**
 * Palette bootstrapper for scheduled micro-UX sweeps.
 * - prints the Theme Skinner guidance
 * - delegates to run-palette.js when available
 */

const fs = require('node:fs');
const path = require('node:path');
const { spawnSync } = require('node:child_process');

const repoRoot = process.cwd();
const paletteScript = path.join(repoRoot, '.Jules', 'run-palette.js');
const promptPath = path.join(repoRoot, 'AI', 'prompts', 'theme-skinner.md');

function readPrompt() {
  if (!fs.existsSync(promptPath)) {
    console.error(`Prompt not found at ${promptPath}`);
    process.exit(1);
  }
  return fs.readFileSync(promptPath, 'utf8');
}

function tryRunPaletteScript() {
  if (!fs.existsSync(paletteScript)) {
    console.log('Palette script not found; printing prompt only.');
    return;
  }

  console.log(`Invoking ${paletteScript} ...`);
  const result = spawnSync('node', [paletteScript], { stdio: 'inherit' });
  if (result.status !== 0) {
    console.warn('Palette script exited with a non-zero status; continue with prompt output.');
  }
}

function main() {
  console.log('\n=== Palette prompt ===');
  console.log(readPrompt());
  console.log('\n=== Execution ===');
  console.log('- Attempts to run .Jules/run-palette.js if present; otherwise acts as documentation.');
  tryRunPaletteScript();
}

main();
